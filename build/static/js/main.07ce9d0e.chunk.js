(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{133:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(32),c=a.n(r),s=a(72),i=a(167),m=a(168),l=a(39),u=a(24),d=a(48),p=a(47),f=a(46),g=a(9),h=a(30),b=a(170),y=a(165),v=a(166),k=a(162),E=a(164),S=a(73),O=(a(85),Object(k.a)({root:{display:"flex",height:"50px",backgroundColor:"#fafafa"},input:{padding:"3px 10px"},button:{width:"60px"}})),x=function(e){var t=Object(n.useState)(""),a=Object(h.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(!1),i=Object(h.a)(s,2),m=i[0],l=i[1],u=O();return o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.sendMessage(r),c("")},className:u.root},m&&o.a.createElement(S.a,{set:"facebook",onSelect:function(e){c("".concat(r).concat(e.native))}}),o.a.createElement("button",{type:"button",className:u.button,onClick:function(){l(!m)}},o.a.createElement(E.a,null)),o.a.createElement(b.a,{placeholder:"Type your message",value:r,onChange:function(e){c(e.target.value)},type:"text",fullWidth:!0,color:"secondary",className:u.input}),o.a.createElement(y.a,{variant:"contained",color:"secondary",size:"large",endIcon:o.a.createElement(v.a,null,"send"),type:"submit"},"Send"))},M=a(70),j=a.n(M),w=a(172),C=a(25),N=a.n(C),I=Object(k.a)({container:{display:"flex"},avatar:{margin:"0.5em"},messageItem:{width:"90%"},span:{marginRight:"0.5em"},paragraph:{wordWrap:"break-word",width:"fit-content",maxWidth:"100%",backgroundColor:"lightgray",padding:"5px 10px",borderRadius:"10px"},fromMe:{backgroundColor:"#372549"}}),D=function(e){var t=e.message,a=e.fromMe,n=I();return o.a.createElement("div",{className:n.container},o.a.createElement(w.a,{className:"".concat(n.avatar," ").concat(a?n.fromMe:"")},t.from.slice(0,1).toUpperCase()),o.a.createElement("div",{className:n.messageItem},o.a.createElement("span",{className:n.span},t.from),o.a.createElement("span",{className:n.span},function(){var e=N()();return N()(t.time).isSame(e,"day")?N()(t.time).format("[Today at] H:mm"):N()(t.time).isBefore(e,"day")&&N()(t.time).isAfter(e.subtract(7,"day"))?N()(t.time).format("dddd H:mm"):N()(t.time).format("Do MMMM YYYY H:mm")}()),o.a.createElement("p",{className:n.paragraph},t.message)))},W=Object(k.a)({root:{overflow:"auto",height:"100%",width:"100%",paddingBottom:"30px"},button:{backgroundColor:"#372549",opacity:"0.8","&:hover":{backgroundColor:"#372549",opacity:"1"}}}),R=function(e){var t=e.messages,a=e.nickname,n=W();return o.a.createElement(j.a,{className:n.root,followButtonClassName:n.button},t.map((function(e){return a===e.from?o.a.createElement(D,{message:e,key:e.id,fromMe:!0}):o.a.createElement(D,{message:e,key:e.id})})))},J=a(169),T=a(171),Y=a(6),A=a(71),B=new Audio(a.n(A).a),F=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={messages:[],nickname:"",errorMessage:"",hidden:!1,count:0},n.connect=function(){n.socket=new WebSocket("ws://st-chat.shas.tel"),n.socket.onmessage=function(e){n.state.hidden&&(n.setState((function(t){return{count:t.count+JSON.parse(e.data).length}})),document.title="(".concat(n.state.count,") You have new messages"),function(e){e.play()}(B)),n.setState({errorMessage:""});var t=JSON.parse(e.data).sort((function(e,t){return e.time-t.time}));n.setState((function(e){return{messages:e.messages.concat(t)}}))};n.socket.onerror=function(e){n.socket.close()},n.socket.onclose=function(e){n.setState({messages:[]}),n.setState({errorMessage:"Lost connection with server. Re-connecting. Restart app if nothing changes"}),setTimeout(void(n.socket&&3!==n.socket.readyState||n.connect()),n.reTryInterval)}},n.sendMessage=function(e){n.socket.send(JSON.stringify({from:n.state.nickname,message:e}))},n.socket=null,n.reTryInterval=1e3,n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("nickname");this.setState((function(e){return{messages:e.messages,nickname:t}})),document.addEventListener("visibilitychange",(function(t){e.setState({hidden:t.target.hidden}),t.target.visible&&e.setState({count:0}),document.title="React App"})),this.connect()}},{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.root},o.a.createElement(R,{messages:this.state.messages,nickname:this.state.nickname}),this.state.errorMessage&&o.a.createElement(J.a,{severity:"error"},o.a.createElement(T.a,null,"Error"),this.state.errorMessage),o.a.createElement(x,{sendMessage:this.sendMessage}))}}]),a}(o.a.Component),H=Object(Y.a)((function(e){return{root:{width:"40vw",minWidth:"300px",minHeight:"400px",height:"60vh",borderRadius:"10px",backgroundColor:"#fafafa",display:"flex",flexDirection:"column"}}}))(F),P=function(){var e=Object(n.useState)(""),t=Object(h.a)(e,2),a=t[0],r=t[1];return o.a.createElement("div",null,o.a.createElement("h1",null,"Welcome"),o.a.createElement("input",{placeholder:"please type your nickname",type:"text",onChange:function(e){return r(e.target.value)}}),o.a.createElement(f.b,{to:"/chat",onClick:function(){localStorage.setItem("nickname",a)}},o.a.createElement("button",{type:"submit"},"Sign-in")))},L=(a(133),function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={nickname:""},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("nickname");this.setState({nickname:e})}},{key:"render",value:function(){return o.a.createElement(f.a,null,o.a.createElement(g.a,{path:"/",exact:!0,component:this.state.nickname?H:P}),o.a.createElement(g.a,{path:"/chat",component:H}))}}]),a}(o.a.Component)),z=Object(s.a)({palette:{background:{primary:"#FEECD0"},secondary:{main:"#372549"}},typography:{h4:{fontFamily:"Playfair Display",fontWeight:"bold"},h6:{fontFamily:"Poppins"},body2:{fontFamily:"Poppins"}}});c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,{theme:z},o.a.createElement(m.a,null),o.a.createElement(L,null))),document.getElementById("root"))},71:function(e,t,a){e.exports=a.p+"static/media/notification_decorative-01.0c23dde9.wav"},77:function(e,t,a){e.exports=a(134)}},[[77,1,2]]]);
//# sourceMappingURL=main.07ce9d0e.chunk.js.map